<div class="inbox-container">
    <!-- Header -->
    <header class="inbox-header">
        <div class="inbox-header-content">
            <div class="inbox-title-section">
                <h1 class="inbox-title">üì¨ Bandeja de Entrada</h1>
                <p class="inbox-subtitle">Productos pendientes de revisi√≥n</p>
            </div>
            <div class="inbox-actions">
                <button 
                    class="btn-icon" 
                    (click)="reload()" 
                    [disabled]="loading()"
                    title="Recargar">
                    üîÑ
                </button>
                <button 
                    class="btn-logout" 
                    (click)="logout()">
                    Cerrar sesi√≥n
                </button>
            </div>
        </div>
    </header>

    <!-- Error Message -->
    @if (error()) {
        <div class="alert-error">
            <strong>‚ö†Ô∏è Error:</strong> {{ error() }}
        </div>
    }

    <!-- Loading State -->
    @if (loading()) {
        <div class="loading-state">
            <div class="spinner-large"></div>
            <p>Cargando productos...</p>
        </div>
    } @else {
        <!-- Stats Bar -->
        @if (rows().length > 0) {
            <div class="stats-bar">
                <div class="stat-item">
                    <span class="stat-value">{{ rows().length }}</span>
                    <span class="stat-label">Pendiente{{ rows().length !== 1 ? 's' : '' }}</span>
                </div>
            </div>

            <!-- Products List -->
            <div class="products-list">
                @for (r of rows(); track r.normalized_id) {
                    <article class="product-card" (click)="open(r.normalized_id)">
                        <!-- Image -->
                        <div class="product-image">
                            @if (r.preview_image_url) {
                                <img [src]="r.preview_image_url" alt="{{ r.listing.title }}" />
                            } @else {
                                <div class="product-image-placeholder">
                                    <span>üì∑</span>
                                    <span class="placeholder-text">Sin imagen</span>
                                </div>
                            }
                        </div>

                        <!-- Content -->
                        <div class="product-content">
                            <h3 class="product-title">{{ r.listing.title || "(sin t√≠tulo)" }}</h3>
                            
                            <div class="product-meta">
                                <div class="meta-item">
                                    <span class="meta-icon">üìÅ</span>
                                    <span>{{ r.listing.category_hint || "Sin categor√≠a" }}</span>
                                </div>
                                <div class="meta-item">
                                    <span class="meta-icon">üè∑Ô∏è</span>
                                    <span>{{ r.listing.items.length }} variante{{ r.listing.items.length !== 1 ? 's' : '' }}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Footer -->
                        <div class="product-footer">
                            <span class="product-time">‚è±Ô∏è {{ timeAgo(r.updated_at ?? r.created_at) }}</span>
                            <button class="btn-review" (click)="open(r.normalized_id); $event.stopPropagation()">
                                Revisar ‚Üí
                            </button>
                        </div>
                    </article>
                }
            </div>
        } @else {
            <!-- Empty State -->
            <div class="empty-state">
                <div class="empty-icon">‚úÖ</div>
                <h2 class="empty-title">¬°Todo al d√≠a!</h2>
                <p class="empty-message">No hay productos pendientes de revisi√≥n</p>
            </div>
        }
    }
</div>